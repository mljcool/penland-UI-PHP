{% comment %}
<documentation>
    <name>HigherEd/Marketing/FetchAllEvents</name>
    <version>1.0.0</version>
    <author>Microsoft Business Application Solutions</author>
    <product>Highered Portal</product>
    <description>
        FetchXML logic to retrieve all events.
    </description>
    <comments>
        If this web template is modified, it may be overridden by the future upgrades.
        This web template should be included in whichever web page needed.
    </comments>
</documentation>
{% endcomment %}
{% assign currentTimeinUTC =   now | date: 'yyyy-MM-ddTHH:mm:ssZ' %}
{% fetchxml eventslistfetch %}
<fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false">
  <entity name="msevtmgt_event">
    <attribute name="msevtmgt_name"></attribute>
    <attribute name="msevtmgt_eventtype"></attribute>
    <attribute name="msevtmgt_eventstartdate"></attribute>
    <attribute name="msevtmgt_eventenddate"></attribute>
    <attribute name="msevtmgt_eventtimezonename"></attribute>
    <attribute name="msevtmgt_eventtimezone"></attribute>
    <attribute name="msevtmgt_publishstatus"></attribute>
    <attribute name="createdon"></attribute>
    <attribute name="msevtmgt_room"></attribute>
    <attribute name="msevtmgt_building"></attribute>
    <attribute name="msevtmgt_streamingenabled"></attribute>
    <attribute name="msevtmgt_attendeeurl"></attribute>
    <attribute name="msevtmgt_registrationcount"></attribute>
    <attribute name="msevtmgt_maximumeventcapacity"></attribute>
    <attribute name="msevtmgt_description"></attribute>
    <attribute name="msevtmgt_expectedoutcome"></attribute>
    <attribute name="msevtmgt_eventid"></attribute>
    <order attribute="msevtmgt_eventstartdate" descending="false"></order>
    <filter type="and">
        <condition attribute="statecode" operator="eq" value="0"></condition>
        <condition attribute="msevtmgt_isrecurringevent" operator="ne" value="1"></condition>
        <condition attribute="msevtmgt_istemplate" operator="ne" value="100000001"></condition>
        <condition attribute="msevtmgt_recurrenteventstatus" operator="ne" value="2"></condition>
       <!-- <condition attribute="msevtmgt_publishstatus" operator="eq" value="100000003"></condition> -->
    </filter>
    <link-entity name="msevtmgt_building" from="msevtmgt_buildingid" to="msevtmgt_building" visible="false" link-type="outer" alias="building">
      <attribute name="msevtmgt_name"></attribute>
      <attribute name="msevtmgt_stateprovince"></attribute>
      <attribute name="msevtmgt_postalcode"></attribute>
      <attribute name="msevtmgt_country"></attribute>
      <attribute name="msevtmgt_city"></attribute>
      <attribute name="msevtmgt_addressline3"></attribute>
      <attribute name="msevtmgt_addressline2"></attribute>
      <attribute name="msevtmgt_addressline1"></attribute>
    </link-entity>
    <link-entity name="msevtmgt_room" from="msevtmgt_roomid" to="msevtmgt_room" visible="false" link-type="outer" alias="room">
      <attribute name="msevtmgt_name"></attribute>
      <attribute name="msevtmgt_capacity"></attribute>
      <attribute name="msevtmgt_building"></attribute>
    </link-entity>
  </entity>
</fetch>
{% endfetchxml %}
{% assign eventlist = eventslistfetch.results.entities %}